---
title: "Running Scans"
description: "Execute security tests on recorded sessions"
---

## Overview

Security scans are executed through `DriverManager.executeScan()`, which replays recorded sessions with security payloads injected into injectable form fields.

<Warning>
  The legacy `Runner` class is deprecated. Use `DriverManager.executeScan()` for
  all new code.
</Warning>

## Quick Start

```typescript
import {
  DriverManager,
  PluginManager,
  parseProjectConfig,
} from "@vulcn/engine";
import browserDriver from "@vulcn/driver-browser";

// Set up drivers
const drivers = new DriverManager();
drivers.register(browserDriver);

// Load plugins from config
const plugins = new PluginManager();
const config = parseProjectConfig({
  payloads: { types: ["xss", "sqli"] },
  detection: { xss: { dialogs: true, severity: "high" } },
});
await plugins.loadFromConfig(config);

// Execute scan
const result = await drivers.executeScan(sessions, plugins, {
  headless: true,
  onFinding: (finding) => {
    console.log(`Found: ${finding.title}`);
  },
});

console.log(`Found ${result.aggregate.findings.length} vulnerabilities`);
await plugins.destroy();
```

## RunnerOptions

```typescript
interface RunnerOptions {
  /** Browser to use (default: "chromium") */
  browser?: "chromium" | "firefox" | "webkit";

  /** Run headless (default: true) */
  headless?: boolean;

  /** Callback for each finding */
  onFinding?: (finding: Finding) => void;
}
```

## RunResult

```typescript
interface RunResult {
  /** All findings detected */
  findings: Finding[];

  /** Number of steps executed */
  stepsExecuted: number;

  /** Number of payloads tested */
  payloadsTested: number;

  /** Execution duration in milliseconds */
  duration: number;

  /** Any errors that occurred */
  errors: string[];
}
```

## Finding Structure

```typescript
interface Finding {
  type: PayloadCategory;
  severity: "critical" | "high" | "medium" | "low" | "info";
  title: string;
  description: string;
  stepId: string;
  payload: string;
  url: string;
  evidence?: string;
  metadata?: Record<string, unknown>;
}
```

## Processing Findings

```typescript
const result = await drivers.executeScan(sessions, plugins);

// Filter by severity
const criticalFindings = result.aggregate.findings.filter(
  (f) => f.severity === "critical" || f.severity === "high",
);

// Group by type
const byType = result.aggregate.findings.reduce(
  (acc, f) => {
    acc[f.type] = acc[f.type] || [];
    acc[f.type].push(f);
    return acc;
  },
  {} as Record<string, Finding[]>,
);

// Generate report
for (const finding of result.aggregate.findings) {
  console.log(`[${finding.severity.toUpperCase()}] ${finding.title}`);
  console.log(`  URL: ${finding.url}`);
  console.log(`  Payload: ${finding.payload}`);
  if (finding.evidence) {
    console.log(`  Evidence: ${finding.evidence}`);
  }
}
```

## Real-time Finding Callbacks

Process findings as they're discovered:

```typescript
const result = await drivers.executeScan(sessions, plugins, {
  headless: true,
  onFinding: (finding) => {
    // Log immediately
    console.log(`ðŸš¨ ${finding.title}`);

    // Send to webhook
    fetch("https://api.example.com/findings", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(finding),
    });

    // Exit on critical
    if (finding.severity === "critical") {
      process.exit(1);
    }
  },
});
```

## Complete Example

```typescript
import {
  DriverManager,
  PluginManager,
  parseProjectConfig,
  loadProject,
} from "@vulcn/engine";
import browserDriver from "@vulcn/driver-browser";

async function runTests() {
  // Load project config from .vulcn.yml
  const project = await loadProject();

  // Set up drivers
  const drivers = new DriverManager();
  drivers.register(browserDriver);

  // Load plugins from project config
  const plugins = new PluginManager();
  await plugins.loadFromConfig(project.config);

  // Load sessions from sessions/ directory
  const sessions = project.sessions;

  // Run scan
  console.log(`Testing ${sessions.length} sessions...`);

  const result = await drivers.executeScan(sessions, plugins, {
    headless: true,
    onFinding: (f) => console.log(`Found: ${f.title}`),
  });

  // Summary
  console.log(`\nResults:`);
  console.log(`  Payloads: ${result.aggregate.payloadsTested}`);
  console.log(`  Duration: ${(result.aggregate.duration / 1000).toFixed(1)}s`);
  console.log(`  Findings: ${result.aggregate.findings.length}`);

  // Cleanup
  await plugins.destroy();

  // Exit with error code if findings
  process.exit(result.aggregate.findings.length > 0 ? 1 : 0);
}

runTests();
```
