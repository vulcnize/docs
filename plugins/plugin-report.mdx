---
title: "@vulcn/plugin-report"
description: "Generate HTML dashboards, JSON, YAML, and SARIF v2.1.0 security reports for GitHub Code Scanning and CI/CD integration"
---

## Overview

The report plugin generates branded, professional security reports at the end of each `vulcn run`. All formats are derived from the **canonical `VulcnReport` model** ‚Äî a single source of truth built once via `buildReport()`, ensuring consistency across HTML, JSON, YAML, and SARIF outputs.

<Info>
  **Multi-session scans**: When running a session directory with multiple
  sessions (e.g. from `vulcn crawl`), the report plugin generates a **single
  aggregate report** containing findings from all sessions ‚Äî not one report per
  session.
</Info>

<CardGroup cols={4}>
  <Card title="HTML" icon="file-code">
    Modern dark-themed dashboard with risk gauge, severity breakdown, passive
    analysis, and expandable finding cards
  </Card>
  <Card title="JSON" icon="braces">
    Machine-readable structured output for CI/CD pipelines, SIEM integration,
    and custom tooling
  </Card>
  <Card title="YAML" icon="file-lines">
    Human-readable YAML with descriptive headers ‚Äî same data model as JSON
  </Card>
  <Card title="SARIF" icon="shield-check">
    SARIF v2.1.0 for GitHub Code Scanning, Azure DevOps, and IDE integration
    with CWE mappings
  </Card>
</CardGroup>

## Installation

The report plugin is bundled with the `vulcn` CLI. No additional installation needed.

For programmatic use:

<CodeGroup>

```bash npm
npm install @vulcn/plugin-report
```

```bash pnpm
pnpm add @vulcn/plugin-report
```

</CodeGroup>

## CLI Usage

### Generate an HTML Report

```bash
vulcn run --report html
```

The HTML report is saved to the current directory and automatically opens in your browser.

### Generate JSON for CI/CD

```bash
vulcn run --report json
```

### Generate SARIF for GitHub Code Scanning

```bash
vulcn run --report sarif
```

Produces a SARIF v2.1.0 file compatible with GitHub Code Scanning, Azure DevOps, and other SARIF-consuming tools.

### Generate All Formats

```bash
vulcn run --report all
```

### Custom Output Directory

```bash
vulcn run --report sarif --report-output ./reports
```

## CLI Options

| Option                  | Description                                           | Default |
| ----------------------- | ----------------------------------------------------- | ------- |
| `-r, --report <format>` | Report format: `html`, `json`, `yaml`, `sarif`, `all` | -       |
| `--report-output <dir>` | Output directory for generated reports                | `.`     |

## Configuration

### Via `.vulcn.yml`

```yaml
report:
  format: sarif
```

### Config Options

| Option      | Type     | Default | Description                                           |
| ----------- | -------- | ------- | ----------------------------------------------------- |
| `format`    | `string` | `html`  | Output format: `html`, `json`, `yaml`, `sarif`, `all` |
| `outputDir` | `string` | `.`     | Directory to write report files                       |

## VulcnReport Model

Starting from v0.5.0, all output formats are projections of the canonical `VulcnReport` model. This model enriches raw scan results with CWE mappings, fingerprints, risk scoring, and passive analysis categorisation.

```
RunResult + Session
       ‚Üì
  buildReport()
       ‚Üì
  VulcnReport (canonical)
       ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  HTML        JSON       YAML       SARIF
```

### Key Fields

| Field             | Type                | Description                                         |
| ----------------- | ------------------- | --------------------------------------------------- |
| `reportVersion`   | `"2.0"`             | Report format version                               |
| `engineVersion`   | `string`            | Engine version that generated the scan              |
| `generatedAt`     | `string`            | ISO timestamp                                       |
| `session`         | `object`            | Session metadata (name, driver, config, step count) |
| `stats`           | `object`            | Execution stats (steps, payloads, duration, errors) |
| `summary`         | `object`            | Aggregated overview (severity counts, risk, URLs)   |
| `rules`           | `ReportRule[]`      | One rule per unique finding type, with CWE data     |
| `findings`        | `EnrichedFinding[]` | All findings with CWE, fingerprints, classification |
| `activeFindings`  | `EnrichedFinding[]` | Active scan findings only                           |
| `passiveAnalysis` | `PassiveAnalysis`   | Structured passive check results by category        |

### Enriched Findings

Every finding is enriched with:

- **`ruleId`** ‚Äî e.g. `VULCN-XSS` (derived from finding type)
- **`cwe`** ‚Äî `{ id: 79, name: "Cross-site Scripting..." }` (from the CWE registry)
- **`securitySeverity`** ‚Äî CVSS-like score (0.0‚Äì10.0)
- **`fingerprint`** ‚Äî stable hash for deduplication across runs
- **`detectionMethod`** ‚Äî `"active"` or `"passive"`
- **`passiveCategory`** ‚Äî category ID when detection is passive

## SARIF Output

The SARIF (Static Analysis Results Interchange Format) output is designed for CI/CD integration, producing reports compatible with:

- **GitHub Code Scanning** ‚Äî findings appear in the Security tab
- **Azure DevOps** ‚Äî SARIF SAST Scans Tab extension
- **VS Code** ‚Äî SARIF Viewer extension
- **Any SARIF v2.1.0 consumer**

### Key Features

- **CWE Mappings** ‚Äî each vulnerability type maps to its CWE ID (XSS ‚Üí CWE-79, SQLi ‚Üí CWE-89, etc.)
- **Security Severity Scores** ‚Äî CVSS-like 0.0‚Äì10.0 scores for sorting in GitHub's Security tab
- **Deterministic Fingerprints** ‚Äî prevents duplicate alerts across runs
- **Rule Deduplication** ‚Äî one SARIF rule per vulnerability type, regardless of finding count
- **Invocation Metadata** ‚Äî session name, duration, steps executed, and payloads tested are preserved

### SARIF Schema

```json
{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Vulcn",
          "version": "0.6.0",
          "informationUri": "https://vulcn.dev",
          "rules": [
            {
              "id": "VULCN-XSS",
              "shortDescription": { "text": "CWE-79: Cross-site Scripting" },
              "helpUri": "https://cwe.mitre.org/data/definitions/79.html",
              "properties": {
                "tags": ["security", "CWE-79", "external/cwe/cwe-79"],
                "security-severity": "7.0"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "VULCN-XSS",
          "level": "error",
          "message": { "text": "XSS Confirmed: alert() executed" },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": { "uri": "https://example.com/search" }
              }
            }
          ],
          "fingerprints": {
            "vulcnFindingV1": "xss:step_003:<script>alert(1)</script>"
          }
        }
      ]
    }
  ]
}
```

### CWE Mappings

| Vuln Type           | SARIF Rule ID             | CWE     | Security Severity |
| ------------------- | ------------------------- | ------- | ----------------- |
| `xss`               | `VULCN-XSS`               | CWE-79  | 7.0 (High)        |
| `sqli`              | `VULCN-SQLI`              | CWE-89  | 9.0 (Critical)    |
| `xxe`               | `VULCN-XXE`               | CWE-611 | 9.0 (Critical)    |
| `command-injection` | `VULCN-COMMAND-INJECTION` | CWE-78  | 9.0 (Critical)    |
| `path-traversal`    | `VULCN-PATH-TRAVERSAL`    | CWE-22  | 7.0 (High)        |
| `open-redirect`     | `VULCN-OPEN-REDIRECT`     | CWE-601 | 4.0 (Medium)      |
| `ssrf`              | `VULCN-SSRF`              | CWE-918 | 7.0 (High)        |
| `reflection`        | `VULCN-REFLECTION`        | CWE-200 | 2.0 (Low)         |

## CI/CD Integration

### GitHub Actions + Code Scanning

```yaml
name: Vulcn Security Scan

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

permissions:
  security-events: write
  contents: read

jobs:
  vulcn-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: Install Vulcn
        run: npm install -g vulcn

      - name: Install browsers
        run: npx playwright install chromium --with-deps

      - name: Run security scan
        run: |
          vulcn run \
            -p xss sqli \
            -r sarif \
            --report-output .

      - name: Upload SARIF to GitHub
        uses: github/codeql-action/upload-sarif@v3
        if: always()
        with:
          sarif_file: vulcn-report.sarif
          category: vulcn-dast
```

<Tip>
  Use `if: always()` on the upload step so SARIF results are always uploaded,
  even if a previous step fails.
</Tip>

### GitLab CI

```yaml
security_scan:
  script:
    - vulcn run --report json --report-output ./reports
  artifacts:
    paths:
      - reports/
    reports:
      security: reports/vulcn-report.json
```

### Exit Codes

| Code | Meaning                                                |
| ---- | ------------------------------------------------------ |
| `0`  | Scan completed successfully (with or without findings) |
| `1`  | Scan failed (load error, timeout, etc.)                |

The exit code indicates **tool success**, not whether vulnerabilities were found. To gate deployments on findings, check the report output:

```bash
vulcn run --report json --report-output ./reports

# Check findings count from the JSON report
FINDINGS=$(jq '.summary.totalFindings' reports/vulcn-report.json)
if [ "$FINDINGS" -gt 0 ]; then
  echo "‚ùå $FINDINGS vulnerabilities found"
  exit 1
fi
```

## HTML Report Features

The HTML report is designed as a modern security dashboard:

- **üõ°Ô∏è Vulcn Branding** ‚Äî Shield logo with gradient header
- **üìä Risk Gauge** ‚Äî Circular SVG gauge showing overall risk score (0‚Äì100)
- **üìà Severity Breakdown** ‚Äî Color-coded bars for Critical, High, Medium, Low, Info
- **üìã Execution Summary** ‚Äî Findings count, payloads tested, steps executed, URLs affected
- **üîí Passive Analysis** ‚Äî Grouped passive findings by category (Security Headers, Cookie Security, CORS, etc.) with remediation guidance
- **üÉè Expandable Findings** ‚Äî Click to reveal description, payload, evidence, CWE reference, and metadata
- **‚ö†Ô∏è Errors Section** ‚Äî Execution errors and timeouts
- **üñ®Ô∏è Print-Friendly** ‚Äî All details auto-expand for PDF export (Cmd+P / Ctrl+P)
- **üåô Dark Theme** ‚Äî Ambient gradient background with Inter + JetBrains Mono typography

## JSON Output Schema

```json
{
  "vulcn": {
    "version": "0.6.0",
    "reportVersion": "2.0",
    "generatedAt": "2026-02-08T00:00:00Z"
  },
  "session": {
    "name": "Login Flow Test",
    "driver": "browser",
    "driverConfig": {
      "startUrl": "https://example.com",
      "browser": "chromium"
    },
    "stepsCount": 6
  },
  "execution": {
    "stepsExecuted": 6,
    "payloadsTested": 42,
    "durationMs": 15230,
    "durationFormatted": "15.2s",
    "errors": []
  },
  "summary": {
    "totalFindings": 4,
    "riskScore": 75,
    "riskLabel": "High",
    "severityCounts": {
      "critical": 1,
      "high": 2,
      "medium": 1,
      "low": 0,
      "info": 0
    },
    "vulnerabilityTypes": ["xss", "reflection"],
    "affectedUrls": ["https://example.com/search"]
  },
  "findings": [
    {
      "type": "xss",
      "severity": "critical",
      "title": "XSS Confirmed: alert() executed",
      "description": "JavaScript alert() dialog was triggered",
      "stepId": "step_005",
      "payload": "<script>alert('XSS')</script>",
      "url": "https://example.com/search",
      "evidence": "Dialog type: alert",
      "ruleId": "VULCN-XSS",
      "cwe": { "id": 79, "name": "Cross-site Scripting" },
      "securitySeverity": "9.0",
      "fingerprint": "xss:step_005:<script>alert('XSS')</script>",
      "detectionMethod": "active"
    }
  ],
  "passiveAnalysis": {
    "totalIssues": 2,
    "categories": [
      {
        "id": "security-headers",
        "label": "Security Headers",
        "status": "warn",
        "issueCount": 2,
        "passedChecks": 4,
        "totalChecks": 6,
        "remedy": "Add the recommended security headers to your server configuration."
      }
    ]
  },
  "rules": [
    {
      "id": "VULCN-XSS",
      "type": "xss",
      "cwe": { "id": 79, "name": "Cross-site Scripting" },
      "severity": "critical",
      "securitySeverity": "9.0",
      "description": "Vulcn detected a potential xss vulnerability."
    }
  ]
}
```

## Programmatic Usage

```typescript
import {
  buildReport,
  generateHtml,
  generateJson,
  generateSarif,
} from "@vulcn/plugin-report";
import type { VulcnReport } from "@vulcn/plugin-report";

// Build the canonical model from raw scan output
const report: VulcnReport = buildReport(
  session,
  result,
  new Date().toISOString(),
  "0.6.0",
);

// Generate any format from the model
const html = generateHtml(report);
const json = generateJson(report);
const sarif = generateSarif(report);

await writeFile("vulcn-report.html", html);
await writeFile("vulcn-report.json", JSON.stringify(json, null, 2));
await writeFile("vulcn-report.sarif", JSON.stringify(sarif, null, 2));
```

## Output Files

| Format | Filename             | Content Type       |
| ------ | -------------------- | ------------------ |
| HTML   | `vulcn-report.html`  | `text/html`        |
| JSON   | `vulcn-report.json`  | `application/json` |
| YAML   | `vulcn-report.yml`   | `text/yaml`        |
| SARIF  | `vulcn-report.sarif` | `application/json` |

<Card title="Plugin Hooks" icon="code" href="/plugins/hooks">
  The report plugin uses the `onRunEnd` hook (single session) and `onScanEnd`
  hook (multi-session aggregate) ‚Äî see all available hooks
</Card>
