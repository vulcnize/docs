---
title: "vulcn run"
seo:
  title: "vulcn run ‚Äî Execute Security Tests with Payload Injection"
  description: "Run automated penetration tests on recorded sessions. Inject XSS, SQLi, and other security payloads into every input field and generate detailed security reports."
description: "Run security tests on a recorded session with payload injection and report generation"
---

## Usage

```bash
vulcn run <session> [options]
```

## Arguments

| Argument  | Description                                          | Required |
| --------- | ---------------------------------------------------- | -------- |
| `session` | Session file (`.vulcn.yml`) or directory (`.vulcn/`) | Yes      |

## Options

| Option                      | Description                                              | Default           |
| --------------------------- | -------------------------------------------------------- | ----------------- |
| `-p, --payload <names...>`  | Payload types to use (xss, sqli, cmd, etc.)              | `xss`             |
| `-f, --payload-file <file>` | Load custom payloads from YAML/JSON file                 | -                 |
| `-b, --browser <browser>`   | Browser to use (chromium, firefox, webkit)               | `chromium`        |
| `--headless`                | Run in headless mode                                     | `true`            |
| `--no-headless`             | Run with visible browser                                 | -                 |
| `-r, --report <format>`     | Generate report: `html`, `json`, `yaml`, `sarif`, `all`  | -                 |
| `--report-output <dir>`     | Output directory for reports                             | `.`               |
| `--passive`                 | Enable passive security scanner (headers, cookies, CORS) | -                 |
| `--creds <file>`            | Credentials file for authenticated scanning              | `.vulcn/auth.enc` |

## Description

The `run` command replays a recorded session while injecting security payloads into every input field. It uses configured detection plugins to identify vulnerabilities and can generate detailed security reports.

It supports both **legacy single-file sessions** (`.vulcn.yml`) and **v2 session directories** (`.vulcn/`) containing multiple sessions with shared configuration.

Payloads are fetched from [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) ‚Äî the largest community-curated collection of security payloads.

## Tiered Scanning

When sessions include HTTP metadata (automatically generated by `vulcn crawl`), Vulcn uses a two-tier scanning approach:

| Tier       | Method         | Speed         | What it Catches                                          |
| ---------- | -------------- | ------------- | -------------------------------------------------------- |
| **Tier 1** | HTTP `fetch()` | ~50ms/payload | Reflected XSS, error-based SQLi, server-side reflection  |
| **Tier 2** | Browser replay | ~2-5s/payload | DOM-based XSS, JavaScript execution, CSP-blocked attacks |

Tier 1 findings are tagged with `metadata.needsBrowserConfirmation: true` ‚Äî the engine can use these to prioritize Tier 2 testing on reflected endpoints.

<Tip>
  Tiered scanning is transparent ‚Äî you don't need any special flags. If HTTP
  metadata is available from crawling, Tier 1 runs automatically.
</Tip>

## Payload Types

| Short Name  | Full Name           | Description                                     |
| ----------- | ------------------- | ----------------------------------------------- |
| `xss`       | `xss`               | Cross-Site Scripting ‚Äî script injection, events |
| `sqli`      | `sql-injection`     | SQL Injection ‚Äî auth bypass, UNION, error-based |
| `xxe`       | `xxe`               | XML External Entity ‚Äî file read, SSRF via XML   |
| `cmd`       | `command-injection` | OS Command Injection ‚Äî shell execution          |
| `redirect`  | `open-redirect`     | Open Redirect ‚Äî URL redirect to attacker domain |
| `traversal` | `path-traversal`    | Path Traversal ‚Äî directory traversal            |

Additional aliases: `sql` ‚Üí `sql-injection`, `command` ‚Üí `command-injection`, `lfi` ‚Üí `path-traversal`

## Examples

### Default Run

```bash
vulcn run session.vulcn.yml
```

Runs with `xss` payloads and the default `@vulcn/plugin-detect-xss` detection.

### Multiple Payload Types

```bash
vulcn run session.vulcn.yml -p xss sqli cmd
```

### Custom Payload File

```bash
vulcn run session.vulcn.yml -f ./my-payloads.yml
```

Custom payload file format:

```yaml
# my-payloads.yml
version: "1"
payloads:
  - name: custom-xss
    category: xss
    description: My custom XSS payloads
    payloads:
      - "<script>alert('custom')</script>"
      - "<img src=x onerror=alert('custom')>"
```

### Visible Browser

```bash
vulcn run session.vulcn.yml --no-headless
```

Watch the browser as tests run. Useful for debugging.

### Authenticated Scanning

```bash
# Scan with stored credentials
vulcn run session.vulcn.yml --creds .vulcn/auth.enc -p xss
```

When `--creds` is provided, Vulcn will:

1. Decrypt the credentials file using `VULCN_KEY` or an interactive prompt
2. Perform a fresh login to capture browser storage state
3. Inject the authenticated cookies/storage into the scanning browser context
4. Run all payloads in an authenticated context

### Full DVWA Workflow

```bash
# 1. Store DVWA credentials
vulcn store admin password --login-url http://localhost:8080/login.php

# 2. Crawl authenticated pages
vulcn crawl http://localhost:8080 --creds .vulcn/auth.enc

# 3. Scan the XSS reflected form
vulcn run sessions/07-crawl-vulnerabilities-xss-r-form-7-name.vulcn.yml \
  --creds .vulcn/auth.enc -p xss -r html
```

### Different Browser

```bash
vulcn run session.vulcn.yml --browser firefox
```

## Generating Reports

Generate security reports alongside your test run:

### HTML Report

```bash
vulcn run session.vulcn.yml --report html
```

Generates a modern, dark-themed HTML dashboard with risk gauges, severity breakdowns, and expandable finding cards. The report automatically opens in your browser.

### JSON Report (for CI/CD)

```bash
vulcn run session.vulcn.yml --report json
```

Produces a machine-readable JSON file for pipeline integration, SIEM ingestion, or custom tooling.

### All Formats

```bash
vulcn run session.vulcn.yml --report all --report-output ./reports
```

Generates HTML, JSON, YAML, and SARIF reports in the specified output directory.

### SARIF Report (for GitHub Code Scanning)

```bash
vulcn run session.vulcn.yml --report sarif
```

Produces a [SARIF v2.1.0](https://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html) file with CWE mappings‚Äîupload directly to GitHub Code Scanning:

```yaml
# .github/workflows/vulcn.yml
- name: Run Vulcn
  run: vulcn run session.vulcn.yml -p xss sqli -r sarif

- name: Upload SARIF
  uses: github/codeql-action/upload-sarif@v3
  if: always()
  with:
    sarif_file: vulcn-report.sarif
    category: vulcn-dast
```

<Tip>
  Combine reports with multiple payload types for comprehensive scans: ```bash
  vulcn run session.vulcn.yml -p xss sqli -r html ```
</Tip>

## Passive Security Scanning

Add `--passive` to analyze HTTP responses for security misconfigurations without injecting payloads:

```bash
# Active + passive scanning
vulcn run session.vulcn.yml -p xss --passive -r html

# Full security assessment
vulcn run session.vulcn.yml -p xss sqli --passive -r sarif
```

The passive scanner detects missing security headers (HSTS, CSP), insecure cookies, information disclosure, CORS misconfigurations, and mixed content. See [`@vulcn/plugin-passive`](/plugins/plugin-passive) for details.

## Output

### Findings

When vulnerabilities are detected:

```bash
üîç Running security tests
   Sessions: 1 (Login Flow Test)
   Payloads: xss, sqli
   Payload count: 100
   Browser: chromium
   Headless: true
   Auth: authenticated (storage state loaded)

‚ö†Ô∏è  FINDING: XSS Confirmed: alert() executed
   Step: step_003
   Payload: <script>alert('XSS')</script>...
   URL: https://example.com/search

üìä Results
   Steps executed: 5
   Payloads tested: 100
   Duration: 45.2s

üö® 1 findings detected!

[HIGH] XSS Confirmed: alert() executed
  Type: xss
  Step: step_003
  URL: https://example.com/search
  Payload: <script>alert('XSS')</script>
```

### No Findings

```bash
üìä Results
   Steps executed: 5
   Payloads tested: 125
   Duration: 45.2s

‚úÖ No vulnerabilities detected
```

## Exit Codes

| Code | Description                             |
| ---- | --------------------------------------- |
| `0`  | No vulnerabilities found                |
| `1`  | Vulnerabilities found or error occurred |

<Tip>
  Use the exit code in CI/CD pipelines to fail builds when vulnerabilities are
  detected: ```bash vulcn run session.vulcn.yml --report json || exit 1 ```
</Tip>

## Detection Plugins

The `run` command automatically loads detection plugins based on the payload types used:

- **`@vulcn/plugin-detect-xss`** ‚Äî Always loaded. Detects XSS by monitoring dialogs and console markers.
- **`@vulcn/plugin-detect-sqli`** ‚Äî Auto-loaded when `sqli` payloads are used. Detects SQL injection via error patterns, timing, and response diffing.

For more detection capabilities, add additional plugins:

```bash
vulcn plugin add @vulcn/plugin-detect-reflection
```

See [Plugins](/plugins/overview) for more information, or check out the [Report Plugin](/plugins/plugin-report) for report generation options.

## See Also

- [vulcn store](/cli/store) ‚Äî Store credentials for authenticated scanning
- [vulcn crawl](/cli/crawl) ‚Äî Auto-discover forms and injection points
- [vulcn record](/cli/record) ‚Äî Manually record browser interactions
