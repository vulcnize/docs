---
title: "vulcn run"
seo:
  title: "vulcn run ‚Äî Execute Security Tests with Payload Injection"
  description: "Run automated penetration tests on recorded sessions. Inject XSS, SQLi, and other security payloads into every input field and generate detailed security reports."
description: "Run security tests with payload injection and report generation"
---

## Usage

```bash
vulcn run [options]
```

The `run` command takes **no arguments** ‚Äî it reads everything from `.vulcn.yml` and loads sessions from `sessions/`. CLI flags override config values for this run only.

## Options

| Option                      | Description                                             | Default     |
| --------------------------- | ------------------------------------------------------- | ----------- |
| `-p, --payload <names...>`  | Payload types (overrides .vulcn.yml)                    | from config |
| `-f, --payload-file <file>` | Load custom payloads from YAML/JSON file                | -           |
| `-b, --browser <browser>`   | Browser to use (chromium, firefox, webkit)              | from config |
| `--headless`                | Run in headless mode                                    | from config |
| `--no-headless`             | Run with visible browser                                | -           |
| `-r, --report <format>`     | Generate report: `html`, `json`, `yaml`, `sarif`, `all` | from config |
| `--report-output <dir>`     | Output directory for reports                            | `reports/`  |
| `--passive`                 | Enable passive security scanner                         | from config |
| `--no-passive`              | Disable passive scanner                                 | -           |
| `--payloadbox`              | Also load PayloadsAllTheThings payloads                 | from config |

## Description

The `run` command loads the Vulcn project, discovers sessions from `sessions/`, loads payloads and detection plugins based on `.vulcn.yml`, and replays every session while injecting security payloads into injectable input fields.

Authentication is auto-discovered from `auth/state.enc` ‚Äî no `--creds` flag needed.

Payloads are curated and context-aware, with community payloads from [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) available as an opt-in.

## How It Works

1. Reads all config from `.vulcn.yml`
2. Loads sessions from `sessions/`
3. CLI flags override config values for this run only
4. Auto-discovers auth from `auth/state.enc`
5. Loads payloads and detection plugins via `PluginManager.loadFromConfig()`
6. Executes tiered scanning
7. Saves reports to `reports/`

## Tiered Scanning

When sessions include HTTP metadata (automatically generated by `vulcn crawl`), Vulcn uses a two-tier scanning approach:

| Tier       | Method         | Speed         | What it Catches                                          |
| ---------- | -------------- | ------------- | -------------------------------------------------------- |
| **Tier 1** | HTTP `fetch()` | ~50ms/payload | Reflected XSS, error-based SQLi, server-side reflection  |
| **Tier 2** | Browser replay | ~2-5s/payload | DOM-based XSS, JavaScript execution, CSP-blocked attacks |

Tier 1 findings are tagged with `metadata.needsBrowserConfirmation: true` ‚Äî the engine can use these to prioritize Tier 2 testing on reflected endpoints.

<Tip>
  Tiered scanning is transparent ‚Äî you don't need any special flags. If HTTP
  metadata is available from crawling, Tier 1 runs automatically.
</Tip>

## Payload Types

| Short Name  | Full Name           | Description                                     |
| ----------- | ------------------- | ----------------------------------------------- |
| `xss`       | `xss`               | Cross-Site Scripting ‚Äî script injection, events |
| `sqli`      | `sql-injection`     | SQL Injection ‚Äî auth bypass, UNION, error-based |
| `xxe`       | `xxe`               | XML External Entity ‚Äî file read, SSRF via XML   |
| `cmd`       | `command-injection` | OS Command Injection ‚Äî shell execution          |
| `redirect`  | `open-redirect`     | Open Redirect ‚Äî URL redirect to attacker domain |
| `traversal` | `path-traversal`    | Path Traversal ‚Äî directory traversal            |

Additional aliases: `sql` ‚Üí `sql-injection`, `command` ‚Üí `command-injection`, `lfi` ‚Üí `path-traversal`

## Examples

### Default Run

```bash
vulcn run
```

Reads everything from `.vulcn.yml` ‚Äî payload types, detection settings, browser config.

### Override Payload Types

```bash
vulcn run -p xss sqli cmd
```

### Custom Payload File

```bash
vulcn run -f ./my-payloads.yml
```

Custom payload file format:

```yaml
# my-payloads.yml
version: "1"
payloads:
  - name: custom-xss
    category: xss
    description: My custom XSS payloads
    payloads:
      - "<script>alert('custom')</script>"
      - "<img src=x onerror=alert('custom')>"
```

### Visible Browser

```bash
vulcn run --no-headless
```

Watch the browser as tests run. Useful for debugging.

### Authenticated Scanning

```bash
# Store credentials first
vulcn store admin password

# Run ‚Äî auth is auto-discovered from auth/state.enc
vulcn run -p xss sqli
```

When `auth/state.enc` is found, Vulcn will:

1. Decrypt the credentials file using `VULCN_KEY` or an interactive prompt
2. Perform a fresh login to capture browser storage state
3. Inject the authenticated cookies/storage into the scanning browser context
4. Run all payloads in an authenticated context

### Full DVWA Workflow

```bash
# 1. Initialize project
vulcn init http://localhost:8080

# 2. Store DVWA credentials
vulcn store admin password

# 3. Crawl authenticated pages
vulcn crawl

# 4. Scan with XSS payloads and generate HTML report
vulcn run -p xss -r html
```

### Different Browser

```bash
vulcn run -b firefox
```

## Generating Reports

Generate security reports alongside your test run:

### HTML Report

```bash
vulcn run -r html
```

Generates a modern, dark-themed HTML dashboard with risk gauges, severity breakdowns, and expandable finding cards. The report automatically opens in your browser.

### JSON Report (for CI/CD)

```bash
vulcn run -r json
```

Produces a machine-readable JSON file for pipeline integration, SIEM ingestion, or custom tooling.

### All Formats

```bash
vulcn run -r all --report-output ./reports
```

Generates HTML, JSON, YAML, and SARIF reports in the specified output directory.

### SARIF Report (for GitHub Code Scanning)

```bash
vulcn run -r sarif
```

Produces a [SARIF v2.1.0](https://docs.oasis-open.org/sarif/sarif/v2.1.0/sarif-v2.1.0.html) file with CWE mappings‚Äîupload directly to GitHub Code Scanning:

```yaml
# .github/workflows/vulcn.yml
- name: Run Vulcn
  run: vulcn run -p xss sqli -r sarif

- name: Upload SARIF
  uses: github/codeql-action/upload-sarif@v3
  if: always()
  with:
    sarif_file: reports/vulcn-report.sarif
    category: vulcn-dast
```

<Tip>
  Combine reports with multiple payload types for comprehensive scans: ```bash
  vulcn run -p xss sqli -r html ```
</Tip>

## Passive Security Scanning

Add `--passive` to analyze HTTP responses for security misconfigurations without injecting payloads:

```bash
# Active + passive scanning
vulcn run -p xss --passive -r html

# Full security assessment
vulcn run -p xss sqli --passive -r sarif
```

The passive scanner detects missing security headers (HSTS, CSP), insecure cookies, information disclosure, CORS misconfigurations, and mixed content. See [`@vulcn/plugin-passive`](/plugins/plugin-passive) for details.

## Output

### Findings

When vulnerabilities are detected:

```bash
üîç Running security tests
   Target: https://example.com
   Sessions: 1 (Login Flow Test)
   Payloads: xss, sqli
   Payload count: 100
   Browser: chromium
   Headless: true
   Auth: authenticated

‚ö†Ô∏è  FINDING: XSS Confirmed: alert() executed
   Step: step_003
   Payload: <script>alert('XSS')</script>...
   URL: https://example.com/search

üìä Results
   Steps executed: 5
   Payloads tested: 100
   Duration: 45.2s

üö® 1 findings detected!

[HIGH] XSS Confirmed: alert() executed
  Type: xss
  Step: step_003
  URL: https://example.com/search
  Payload: <script>alert('XSS')</script>
```

### No Findings

```bash
üìä Results
   Steps executed: 5
   Payloads tested: 125
   Duration: 45.2s

‚úÖ No vulnerabilities detected
```

## Exit Codes

| Code | Description                                            |
| ---- | ------------------------------------------------------ |
| `0`  | Scan completed successfully (with or without findings) |
| `1`  | Scan failed (load error, timeout, etc.)                |

<Tip>
  The exit code indicates **tool success**, not whether vulnerabilities were found. To gate CI/CD pipelines on findings, check the report output:

```bash
vulcn run -r json --report-output ./reports
FINDINGS=$(jq '.summary.totalFindings' reports/vulcn-report.json)
[ "$FINDINGS" -gt 0 ] && exit 1
```

</Tip>

## Detection Plugins

The `run` command automatically loads detection plugins based on the `.vulcn.yml` config:

- **`@vulcn/plugin-detect-xss`** ‚Äî Always loaded. Detects XSS by monitoring dialogs and console markers.
- **`@vulcn/plugin-detect-sqli`** ‚Äî Auto-loaded when `sqli` payloads are used. Detects SQL injection via error patterns, timing, and response diffing.
- **`@vulcn/plugin-detect-reflection`** ‚Äî Loaded when `detection.reflection.enabled` is true.
- **`@vulcn/plugin-passive`** ‚Äî Loaded when `detection.passive` is true or `--passive` flag is used.

See [Plugins](/plugins/overview) for more information.

## See Also

- [vulcn store](/cli/store) ‚Äî Store credentials for authenticated scanning
- [vulcn crawl](/cli/crawl) ‚Äî Auto-discover forms and injection points
- [vulcn record](/cli/record) ‚Äî Manually record browser interactions
