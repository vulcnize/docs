---
title: "Types"
description: "TypeScript type definitions for Vulcn"
---

## Core Types

### Session

```typescript
interface Session {
  /** Session name */
  name: string;

  /** Driver used for recording/replay */
  driver: string;

  /** Driver-specific configuration */
  driverConfig: Record<string, unknown>;

  /** Recorded steps */
  steps: Step[];

  /** Session metadata */
  metadata?: {
    recordedAt?: string;
    version?: string;
    [key: string]: unknown;
  };
}
```

### Step

```typescript
interface Step {
  /** Unique step ID */
  id: string;

  /** Step type (driver-prefixed, e.g. "browser.input") */
  type: string;

  /** Timestamp when step was recorded */
  timestamp: number;

  /** URL for navigate steps */
  url?: string;

  /** CSS selector for interaction steps */
  selector?: string;

  /** Value for input steps */
  value?: string;

  /** Whether this field should receive payloads */
  injectable?: boolean;

  /** Additional driver-specific properties */
  [key: string]: unknown;
}
```

### BrowserType

```typescript
type BrowserType = "chromium" | "firefox" | "webkit";
```

## Finding Types

### Finding

```typescript
interface Finding {
  /** Vulnerability type */
  type: PayloadCategory;

  /** Severity level */
  severity: Severity;

  /** Finding title */
  title: string;

  /** Detailed description */
  description: string;

  /** Step that triggered the finding */
  stepId: string;

  /** Payload that caused the finding */
  payload: string;

  /** URL where finding occurred */
  url: string;

  /** Evidence string */
  evidence?: string;

  /** Plugin-specific metadata */
  metadata?: Record<string, unknown>;
}

type Severity = "critical" | "high" | "medium" | "low" | "info";
```

### RunResult

```typescript
interface RunResult {
  /** All findings detected */
  findings: Finding[];

  /** Number of steps executed */
  stepsExecuted: number;

  /** Number of payloads tested */
  payloadsTested: number;

  /** Execution duration in milliseconds */
  duration: number;

  /** Errors that occurred */
  errors: string[];
}
```

## Payload Types

### RuntimePayload

```typescript
interface RuntimePayload {
  /** Unique name */
  name: string;

  /** Vulnerability category */
  category: PayloadCategory;

  /** Description */
  description: string;

  /** Payload strings to inject */
  payloads: string[];

  /** Detection patterns (regex) */
  detectPatterns: RegExp[];

  /** Payload source */
  source: PayloadSource;
}
```

### PayloadCategory

```typescript
type PayloadCategory =
  | "xss"
  | "sqli"
  | "ssrf"
  | "xxe"
  | "command-injection"
  | "path-traversal"
  | "open-redirect"
  | "reflection"
  | "security-misconfiguration"
  | "information-disclosure"
  | "custom";
```

### PayloadSource

```typescript
type PayloadSource = "custom" | "payloadbox" | "plugin";
```

## Plugin Types

### VulcnPlugin

```typescript
interface VulcnPlugin {
  /** Unique plugin name */
  name: string;

  /** Semantic version */
  version: string;

  /** Plugin API version (default: 1) */
  apiVersion?: number;

  /** Description */
  description?: string;

  /** Zod config schema */
  configSchema?: z.ZodSchema;

  /** Lifecycle hooks */
  hooks?: PluginHooks;

  /** Payloads provided by plugin */
  payloads?: RuntimePayload[] | (() => Promise<RuntimePayload[]>);
}
```

### PluginHooks

```typescript
interface PluginHooks {
  // Initialization
  onInit?: (ctx: PluginContext) => Promise<void>;
  onDestroy?: (ctx: PluginContext) => Promise<void>;

  // Recording
  onRecordStart?: (ctx: RecordContext) => Promise<void>;
  onRecordStep?: (step: Step, ctx: RecordContext) => Promise<Step | null>;
  onRecordEnd?: (session: Session, ctx: RecordContext) => Promise<Session>;

  // Scan-level (wraps all sessions)
  onScanStart?: (ctx: ScanContext) => Promise<void>;
  onScanEnd?: (result: RunResult, ctx: ScanContext) => Promise<RunResult>;

  // Per-session
  onRunStart?: (ctx: RunContext) => Promise<void>;
  onBeforePayload?: (
    payload: string,
    step: Step,
    ctx: RunContext,
  ) => Promise<string>;
  onAfterPayload?: (ctx: DetectContext) => Promise<Finding[]>;
  onBeforeClose?: (ctx: PluginContext) => Promise<void>;
  onRunEnd?: (result: RunResult, ctx: RunContext) => Promise<RunResult>;

  // Browser events
  onDialog?: (dialog: Dialog, ctx: DetectContext) => Promise<Finding | null>;
  onConsoleMessage?: (
    msg: ConsoleMessage,
    ctx: DetectContext,
  ) => Promise<Finding | null>;
  onPageLoad?: (page: Page, ctx: DetectContext) => Promise<Finding[]>;
}
```

## Context Types

### PluginContext

```typescript
interface PluginContext {
  config: Record<string, unknown>;
  engine: EngineInfo;
  payloads: RuntimePayload[];
  findings: Finding[];
  addFinding: (finding: Finding) => void;
  logger: PluginLogger;
  fetch: typeof fetch;
}

interface EngineInfo {
  version: string;
  pluginApiVersion: number;
}

interface PluginLogger {
  debug(msg: string, ...args: unknown[]): void;
  info(msg: string, ...args: unknown[]): void;
  warn(msg: string, ...args: unknown[]): void;
  error(msg: string, ...args: unknown[]): void;
}
```

### RecordContext

```typescript
interface RecordContext extends PluginContext {
  startUrl: string;
  browser: BrowserType;
  page: Page;
}
```

### RunContext

```typescript
interface RunContext extends PluginContext {
  session: Session;
  page: Page;
  browser: BrowserType;
  headless: boolean;
}
```

### DetectContext

```typescript
interface DetectContext extends RunContext {
  step: Step;
  payloadSet: RuntimePayload;
  payloadValue: string;
  stepId: string;
}
```

### ScanContext

```typescript
interface ScanContext extends PluginContext {
  /** All sessions in this scan */
  sessions: Session[];

  /** Whether running headless */
  headless: boolean;

  /** Total sessions count */
  sessionCount: number;
}
```

## Options Types

### RecorderOptions

```typescript
interface RecorderOptions {
  browser?: BrowserType;
  viewport?: { width: number; height: number };
  headless?: boolean;
}
```

### RunnerOptions

```typescript
interface RunnerOptions {
  browser?: BrowserType;
  headless?: boolean;
  onFinding?: (finding: Finding) => void;
}
```

## Configuration Types

### VulcnConfig

```typescript
interface VulcnConfig {
  version: string;
  plugins?: PluginConfig[];
  settings?: {
    browser?: BrowserType;
    headless?: boolean;
    timeout?: number;
  };
}

interface PluginConfig {
  name: string;
  config?: Record<string, unknown>;
  enabled?: boolean;
}
```

## Auth Types

### Credentials

```typescript
type Credentials = FormCredentials | HeaderCredentials;

interface FormCredentials {
  type: "form";
  username: string;
  password: string;
  loginUrl?: string;
  usernameSelector?: string;
  passwordSelector?: string;
}

interface HeaderCredentials {
  type: "header";
  headerName: string;
  headerValue: string;
}
```

### AuthConfig

```typescript
interface AuthConfig {
  strategy: "storage-state" | "header";
  loginUrl?: string;
  loggedInIndicator?: string;
  loggedOutIndicator?: string;
  sessionExpiry?: {
    statusCodes?: number[];
    redirectPattern?: string;
    pageContent?: string;
  };
}
```

### Encryption Functions

```typescript
/** Encrypt credentials with AES-256-GCM */
function encryptCredentials(
  credentials: Credentials,
  passphrase: string,
): string;

/** Decrypt credentials */
function decryptCredentials(encrypted: string, passphrase: string): Credentials;

/** Encrypt Playwright storage state */
function encryptStorageState(state: string, passphrase: string): string;

/** Decrypt storage state */
function decryptStorageState(encrypted: string, passphrase: string): string;

/** Get passphrase from VULCN_KEY env variable */
function getPassphrase(): string;
```

## Crawl Types

### CrawlOptions

```typescript
interface CrawlOptions {
  /** Maximum crawl depth (default: 2) */
  maxDepth?: number;

  /** Maximum pages to visit (default: 20) */
  maxPages?: number;

  /** Timeout per page in ms (default: 10000) */
  pageTimeout?: number;

  /** Only crawl same origin (default: true) */
  sameOrigin?: boolean;

  /** Playwright storage state JSON for authenticated crawling */
  storageState?: string;

  /** Callback when a page is crawled */
  onPageCrawled?: (url: string, formsFound: number) => void;
}
```

## Session Directory Types

### ScanManifest

The v2 session directory format uses a manifest file:

```typescript
interface ScanManifest {
  /** Config version */
  version: string;

  /** Target URL */
  target: string;

  /** Driver to use */
  driver: string;

  /** Driver config (browser, headless, viewport, etc.) */
  driverConfig: Record<string, unknown>;

  /** Session references */
  sessions: SessionRef[];

  /** Auth configuration */
  auth?: AuthConfig;
}

interface SessionRef {
  /** Session filename (relative to sessions/ dir) */
  file: string;

  /** Human-readable label */
  label?: string;
}
```

### CapturedRequest

HTTP request metadata captured during crawling for Tier 1 scanning:

```typescript
interface CapturedRequest {
  /** Request method (GET, POST, etc.) */
  method: string;

  /** Full URL */
  url: string;

  /** Request headers */
  headers: Record<string, string>;

  /** Form data (for POST) */
  body?: string;

  /** Content type (e.g. application/x-www-form-urlencoded) */
  contentType?: string;

  /** Which form field should receive payloads */
  injectableField?: string;

  /** Session name this request belongs to */
  sessionName: string;
}
```

### CrawlResult

Return type of `crawlAndBuildSessions()`:

```typescript
interface CrawlResult {
  /** Sessions for Tier 2 browser replay */
  sessions: Session[];

  /** HTTP request metadata for Tier 1 fast scan */
  capturedRequests: CapturedRequest[];
}
```

## HTTP Scan Types

### HttpScanResult

```typescript
interface HttpScanResult {
  /** Findings detected during HTTP scanning */
  findings: Finding[];

  /** Requests where payloads were reflected in responses */
  reflectedRequests: ReflectedRequest[];

  /** Total HTTP requests sent */
  requestsSent: number;

  /** Duration in milliseconds */
  duration: number;
}
```

### ReflectedRequest

```typescript
interface ReflectedRequest {
  /** Original captured request */
  request: CapturedRequest;

  /** Payload that was reflected */
  payload: string;

  /** Payload category (xss, sqli, etc.) */
  category: PayloadCategory;

  /** HTTP response status code */
  responseStatus: number;
}
```

### HttpScanOptions

```typescript
interface HttpScanOptions {
  /** Request timeout in ms (default: 10000) */
  timeout?: number;

  /** Max concurrent requests (default: 10) */
  concurrency?: number;

  /** Cookies to attach to requests */
  cookies?: string;

  /** Extra headers */
  headers?: Record<string, string>;

  /** Progress callback */
  onProgress?: (completed: number, total: number) => void;
}
```
